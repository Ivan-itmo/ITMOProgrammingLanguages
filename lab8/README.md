# Практическое занятие №8: Метапрограммирование и кодогенерация в .NET

Изучение продвинутых механизмов построения **расширяемых и высокопроизводительных систем**:
- Декларативное проектирование через **пользовательские атрибуты**
- Динамическое обнаружение и выполнение логики через **Reflection**
- Оптимизация вызовов с помощью **Reflection.Emit**

---

## Архитектура проекта

### 1. **Метаданные и плагины (Runtime Extensibility)**

- Атрибут `[CombatSkill]` маркирует методы как игровые навыки.  
- Атрибут `[GameAttribute]` указывает на классы с игровой логикой.  
- Ядро (`SkillEngine`) сканирует сборки, находит методы и строит **исполняемый пайплайн** без жёсткой привязки.

Взять за основу `part01` и расширить методами загрузки внешнего файла, написанного на языке программирования C#.

Загруженный файл должен быть скомпилирован в run-time, загружен как динамическая библиотека (DLL Assembly), и из него должны быть извлечены все классы и методы с атрибутами `GameAttribute` и `CombatSkillAttribute` соответственно.

При запуске приложения следует загрузить все файлы из каталога `Мои Документы/SkillEngine`. Если файл не удаётся скомпилировать — следует сообщить об этом и продолжить.

После загрузки всех методов их надо отсортировать по приоритету и выполнить.

Разработанное приложение должно иметь следующую структуру:

### [`Core`] — Class Library
- `UnitStats`
- `GameAttribute`
- `CombatSkillAttribute`
- `TriggerType`
- `BattleContext`

### [`Vampire`] — Class Library
- использует `Core`
- Реализует `VampireMechanics`

### [`Engine`] — Class Library
- использует `Core`
- Загружает `Assembly` и ищет там `CombatSkillAttribute`-ы  
- Создаёт Delegate для найденных методов (используя `Action<BattleContext>`) при загрузке `Assembly`  
- Загружает Dynamic Library по имени файла и ищет там `CombatSkillAttribute`-ы  
- Загружает исходный код C#, собирает в Assembly и ищет там `CombatSkillAttribute`-ы  
- Сканирует указанный путь на `dll` и `cs` и загружает все  
- Модифицирует вызов пайплайна для использования делегата  

### [`Main`] — Console App
- использует `Core` и `Engine`
- `Program.cs`, который ищет все плагины (`*.dll`, `*.cs`) в `Мои Документы/SkillEngine`, загружает их и выполняет пайплайн